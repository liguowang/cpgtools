<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>21. dmc_Bayes.py &mdash; CpGtools documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c97855ec" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="22. dmc_bb.py" href="dmc_bb.html" />
    <link rel="prev" title="20. beta_trichotmize.py" href="beta_trichotmize.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../index.html" class="icon icon-home">
            CpGtools
              <img src="../_static/CpGtools_logo3.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">CpGtools Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../change_log.html">3. CpGtools Release history</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Format</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../input_format.html">1. Input file and data format</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Test and Demo Datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dataset.html">1. Pre-compiled datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage Information</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="CpG_aggregation.html">1. CpG_aggregation.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="CpG_anno_position.html">2. CpG_anno_position.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="CpG_anno_probe.html">3. CpG_anno_probe.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="CpG_density_gene_centered.html">4. CpG_density_gene_centered.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="CpG_distrb_chrom.html">5. CpG_distrb_chrom.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="CpG_distrb_gene_centered.html">6. CpG_distrb_gene_centered.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="CpG_distrb_region.html">7. CpG_distrb_region.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="CpG_logo.html">8. CpG_logo.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="CpG_to_gene.html">9. CpG_to_gene.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta_PCA.html">10. beta_PCA.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta_UMAP.html">11. beta_UMAP.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta_jitter_plot.html">12. beta_jitter_plot.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta_m_conversion.html">13. beta_m_conversion.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta_profile_gene_centered.html">14. beta_profile_gene_centered.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta_profile_region.html">15. beta_profile_region.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta_stacked_barplot.html">16. beta_stacked_barplot.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta_stats.html">17. beta_stats.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta_tSNE.html">18. beta_tSNE.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta_topN.html">19. beta_topN.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta_trichotmize.html">20. beta_trichotmize.py</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">21. dmc_Bayes.py</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#description">21.1. Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#options">21.2. Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-files-examples">21.3. Input files (examples)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#command">21.4. Command</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-files">21.5. Output files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dmc_bb.html">22. dmc_bb.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="dmc_fisher.html">23. dmc_fisher.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="dmc_glm.html">24. dmc_glm.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="dmc_logit.html">25. dmc_logit.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="dmc_nonparametric.html">26. dmc_nonparametric.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="dmc_ttest.html">27. dmc_ttest.py</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Compare Differential Analysis Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../compare_diff_tools.html">1. Compare Differential CpG Analysis Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compare_diff_tools.html#p-value-distributions">2. P-value distributions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Liscense</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../liscense.html">LICENSE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CpGtools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">21. </span>dmc_Bayes.py</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/demo/dmc_Bayes.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dmc-bayes-py">
<h1><span class="section-number">21. </span>dmc_Bayes.py<a class="headerlink" href="#dmc-bayes-py" title="Permalink to this heading"></a></h1>
<section id="description">
<h2><span class="section-number">21.1. </span>Description<a class="headerlink" href="#description" title="Permalink to this heading"></a></h2>
<p>Different from statistical testing, this program tries to estimates “how different the
means between the two groups are” using the Bayesian approach. An <a class="reference external" href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo">MCMC</a>
is used to estimate the “means”, “difference of means”, “95% HDI (highest posterior density interval)”,
and the posterior probability that the HDI does NOT include “0”.</p>
<p>It is similar to John Kruschke’s <a class="reference external" href="http://www.indiana.edu/~kruschke/BEST/">BEST algorithm</a>
(Bayesian Estimation Supersedes T test)</p>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p>This program is much slower than T-test due to MCMC (Markov chain Monte Carlo) step.
Running it with multiple threads is highly recommended.</p></li>
</ul>
</section>
<section id="options">
<h2><span class="section-number">21.2. </span>Options<a class="headerlink" href="#options" title="Permalink to this heading"></a></h2>
<blockquote>
<div><dl class="option-list">
<dt><kbd><span class="option">--version</span></kbd></dt>
<dd><p>show program’s version number and exit</p>
</dd>
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>show this help message and exit</p>
</dd>
<dt><kbd><span class="option">-i <var>INPUT_FILE</var></span>, <span class="option">--input_file=<var>INPUT_FILE</var></span></kbd></dt>
<dd><p>Data file containing beta values with the 1st row
containing sample IDs (must be unique) and the 1st
column containing CpG positions or probe IDs (must be
unique). Except for the 1st row and 1st column, any
non-numerical values will be considered as “missing
values” and ignored. This file can be a regular text
file or compressed file (.gz, .bz2).</p>
</dd>
<dt><kbd><span class="option">-g <var>GROUP_FILE</var></span>, <span class="option">--group=<var>GROUP_FILE</var></span></kbd></dt>
<dd><p>Group file defining the biological group of each
sample. It is a comma-separated 2 columns file with
the 1st column containing sample IDs, and the 2nd
column containing group IDs.  It must have a header
row. Sample IDs should match to the “Data file”. Note:
Only for two group comparison.</p>
</dd>
<dt><kbd><span class="option">-n <var>N_ITER</var></span>, <span class="option">--niter=<var>N_ITER</var></span></kbd></dt>
<dd><p>Iteration times when using MCMC Metropolis-Hastings’s
agorithm to draw samples from the posterior
distribution. default=5000</p>
</dd>
<dt><kbd><span class="option">-b <var>N_BURN</var></span>, <span class="option">--burnin=<var>N_BURN</var></span></kbd></dt>
<dd><p>Number of simulated samples to discard. Thes initial
samples are usually not completely valid because the
Markov Chain has not stabilized to the stationary
distribution. default=500.</p>
</dd>
<dt><kbd><span class="option">-p <var>N_PROCESS</var></span>, <span class="option">--processor=<var>N_PROCESS</var></span></kbd></dt>
<dd><p>The number of processes. default=1</p>
</dd>
<dt><kbd><span class="option">-s <var>SEED</var></span>, <span class="option">--seed=<var>SEED</var></span></kbd></dt>
<dd><p>The seed used by the random number generator.
default=99</p>
</dd>
<dt><kbd><span class="option">-o <var>OUT_FILE</var></span>, <span class="option">--output=<var>OUT_FILE</var></span></kbd></dt>
<dd><p>The prefix of the output file.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="input-files-examples">
<h2><span class="section-number">21.3. </span>Input files (examples)<a class="headerlink" href="#input-files-examples" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://sourceforge.net/projects/cpgtools/files/test/test_05_TwoGroup.tsv.gz">test_05_TwoGroup.tsv.gz</a></p></li>
<li><p><a class="reference external" href="https://sourceforge.net/projects/cpgtools/files/test/test_05_TwoGroup.grp.csv">test_05_TwoGroup.grp.csv</a></p></li>
</ul>
</section>
<section id="command">
<h2><span class="section-number">21.4. </span>Command<a class="headerlink" href="#command" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$  dmc_Bayes.py -i test_05_TwoGroup.tsv.gz -g test_05_TwoGroup.grp.csv.gz -p 10 -o dmc_output
</pre></div>
</div>
</section>
<section id="output-files">
<h2><span class="section-number">21.5. </span>Output files<a class="headerlink" href="#output-files" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><strong>dmc_output.bayes.tsv</strong>: this file consists of 6 columns:</p></li>
</ul>
<blockquote>
<div><ol class="arabic simple">
<li><p>ID : CpG ID</p></li>
<li><p><em>mu1</em> : Mean methylation level estimated from group1</p></li>
<li><p><em>mu2</em> : Mean methylation level estimated from gropu2</p></li>
<li><p><em>mu_diff</em> : Difference between mu1 and mu2</p></li>
<li><p><em>mu_diff</em> (95% HDI) : 95% of “High Density Interval” of <em>mu_diff</em>. The HDI indicates which
points of distribution are most credible. This interval spans 95% of <em>mu_diff</em>’s
distribution.</p></li>
<li><p>The probability that <em>mu1</em> and <em>mu2</em> are different.</p></li>
</ol>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$head -10 dmc_output.bayes.tsv

ID     mu1     mu2     mu_diff mu_diff (95% HDI)       Probability
cg00001099     0.775209        0.795404        -0.020196       (-0.065148,0.023974)    0.811024
cg00000363     0.610565        0.469523        0.141042        (0.030769,0.232965)     0.994665
cg00000884     0.845973        0.873761        -0.027787       (-0.051976,-0.004398)   0.984882
cg00000714     0.190868        0.199233        -0.008365       (-0.030071,0.014006)    0.816141
cg00000957     0.772905        0.827528        -0.054623       (-0.092116,-0.016465)   0.995327
cg00000292     0.748394        0.766326        -0.017932       (-0.051286,0.012583)    0.889729
cg00000807     0.729162        0.683732        0.045430        (-0.001523,0.086588)    0.981551
cg00000721     0.935903        0.935080        0.000823        (-0.013210,0.018628)    0.508686
cg00000948     0.898609        0.897536        0.001073        (-0.020663,0.026813)    0.518238
</pre></div>
</div>
<p>mu1 and mu2 can be considered as <em>significantly</em> different if the 95% HDI does NOT include zero.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="beta_trichotmize.html" class="btn btn-neutral float-left" title="20. beta_trichotmize.py" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dmc_bb.html" class="btn btn-neutral float-right" title="22. dmc_bb.py" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Liguo Wang.
      <span class="lastupdated">Last updated on Sep 05, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>